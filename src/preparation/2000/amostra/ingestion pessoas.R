# apagando os data frames do enviroment

rm(list = ls())

# Definir o nome do arquivo
file_path <- "data/landing/2000/amostra/Pes14.txt"


# Definir larguras das colunas conforme a descrição das variáveis
col_widths <- c(2,
                4,
                5,
                7,
                9,
                11,
                8,
                2,
                2,
                13,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                1,
                2,
                1,
                1,
                1,
                3,
                1,
                2,
                1,
                1,
                1,
                1,
                3,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                2,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                4,
                1,
                2,
                1,
                2,
                1,
                2,
                1,
                1,
                1,
                7,
                1,
                2,
                1,
                7,
                1,
                1,
                1,
                1,
                1,
                2,
                1,
                1,
                1,
                1,
                1,
                2,
                1,
                1,
                1,
                2,
                1,
                2,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                4,
                1,
                5,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                1,
                6,
                1,
                6,
                6,
                1,
                1,
                6,
                1,
                6,
                6,
                6,
                6,
                2,
                1,
                2,
                1,
                3,
                1,
                1,
                1,
                1,
                6,
                1,
                6,
                1,
                6,
                1,
                6,
                1,
                6,
                1,
                6,
                6,
                2,
                1,
                2,
                2,
                1,
                2,
                1,
                2,
                1,
                11,
                2,
                2,
                2,
                1,
                2,
                1,
                2,
                1,
                2,
                1,
                1,
                1,
                2,
                1,
                2,
                1,
                3,
                3,
                3,
                3,
                3,
                3,
                3
                )

# Nome das colunas
col_names <- c("V0102",
               "V1002",
               "V1003",
               "V1103",
               "V0104",
               "V0105",
               "V0300",
               "V0400",
               "V1004",
               "AREAP",
               "V1001",
               "V1005",
               "V1006",
               "V1007",
               "MARCA",
               "V0401",
               "M0401",
               "V0402",
               "M0402",
               "V0403",
               "M0403",
               "V0404",
               "M0404",
               "V4572",
               "M4752",
               "V4754",
               "M4754",
               "V4070",
               "V0408",
               "M0408",
               "V4090",
               "M4090",
               "V0410",
               "M0410",
               "V0411",
               "M0411",
               "V0412",
               "M0412",
               "V0413",
               "M0413",
               "V0414",
               "M0414",
               "V0415",
               "M0415",
               "V0416",
               "M0416",
               "V0417",
               "M0417",
               "V0418",
               "M0418",
               "V0419",
               "M0419",
               "V0420",
               "M0420",
               "V4210",
               "M4210",
               "V0422",
               "M0422",
               "V4230",
               "M4230",
               "V0424",
               "M0424",
               "V4250",
               "M4250",
               "V4260",
               "M4260",
               "V4276",
               "M4276",
               "V0428",
               "M0428",
               "V0429",
               "M0429",
               "V0430",
               "M0430",
               "V0431",
               "M0431",
               "V0432",
               "M0432",
               "V0433",
               "M0433",
               "V0434",
               "M0434",
               "V4355",
               "M0435",
               "V4300",
               "V0436",
               "M0436",
               "V0437",
               "M0437",
               "V0438",
               "M0438",
               "V0439",
               "M0439",
               "V0440",
               "M0440",
               "V0441",
               "M0441",
               "V0442",
               "M0442",
               "V0443",
               "M0443",
               "V0444",
               "M0444",
               "V4452",
               "M4452",
               "V4462",
               "M4462",
               "V0447",
               "M0447",
               "V0448",
               "M0448",
               "V0449",
               "M0449",
               "V0450",
               "M0450",
               "V4511",
               "M4511",
               "V4512",
               "M4512",
               "V4513",
               "V4514",
               "V4521",
               "M4521",
               "V4522",
               "M4522",
               "V4523",
               "V4524",
               "V4525",
               "V4526",
               "V0453",
               "M4523",
               "V0454",
               "M0454",
               "V4534",
               "V0455",
               "M0455",
               "V0456",
               "M0456",
               "V4573",
               "M4573",
               "V4583",
               "M4583",
               "V4593",
               "M4593",
               "V4603",
               "M4603",
               "V4613",
               "M4613",
               "V4614",
               "V4615",
               "V4620",
               "M4620",
               "V0463",
               "V4654",
               "M4654",
               "V4670",
               "M4670",
               "V4690",
               "M0463",
               "P001",
               "ESTR",
               "ESTRP",
               "V4621",
               "M4621",
               "V4622",
               "M4622",
               "V4631",
               "M4631",
               "V4632",
               "M4632",
               "V0464",
               "M0464",
               "V4671",
               "M4671",
               "V4672",
               "M4672",
               "V4354",
               "V4219",
               "V4239",
               "V4269",
               "V4279",
               "V4451",
               "V4461"
               )

# Ler o arquivo usando read.fwf
data <- read.fwf(file_path, widths = col_widths, col.names = col_names)

# Visualizar os primeiros registros para verificar se os dados foram importados corretamente
head(data)

#faz uma breve descrição dos dados
# profile simples


dfSummary(data)

# salvando na camada sot - dado para ser usado

save(data, file = "data/raw/2000/amostra/pes_2000_14.RData")


